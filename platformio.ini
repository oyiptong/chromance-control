[platformio]
default_envs = diagnostic

[env:diagnostic]
platform = espressif32
board = featheresp32
framework = arduino
monitor_speed = 115200

lib_deps =
  adafruit/Adafruit DotStar @ ^1.2.0

; OTA-capable partition layout (two-slot app + OTA data + SPIFFS).
board_build.partitions = min_spiffs.csv

; Prefer build-time secrets from environment variables:
; WIFI_SSID='...' WIFI_PASSWORD='...' pio run -e diagnostic
extra_scripts =
  pre:scripts/wifi_from_env.py

build_src_filter =
  -<*>
  +<main_diagnostic.cpp>
  +<core/**>
  +<platform/**>

[env:native]
platform = native
test_framework = unity
test_build_src = true

build_src_filter =
  -<*>
  +<core/**>
